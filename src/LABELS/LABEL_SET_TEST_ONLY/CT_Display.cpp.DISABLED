#include "../../Globals.h"
#include "CT_Display.h"
#include "DisplayMapping.h"

char hud_ltdr[6] = {};
bool hud_ltdr_dirty = false;
char last_hud_ltdr[6] = {};
char ifei_bingo[6] = {};
bool ifei_bingo_dirty = false;
char last_ifei_bingo[6] = {};
char ifei_bingo_texture[2] = {};
bool ifei_bingo_texture_dirty = false;
char last_ifei_bingo_texture[2] = {};
char ifei_clock_h[3] = {};
bool ifei_clock_h_dirty = false;
char last_ifei_clock_h[3] = {};
char ifei_clock_m[3] = {};
bool ifei_clock_m_dirty = false;
char last_ifei_clock_m[3] = {};
char ifei_clock_s[3] = {};
bool ifei_clock_s_dirty = false;
char last_ifei_clock_s[3] = {};
char ifei_codes[4] = {};
bool ifei_codes_dirty = false;
char last_ifei_codes[4] = {};
char ifei_dd_1[2] = {};
bool ifei_dd_1_dirty = false;
char last_ifei_dd_1[2] = {};
char ifei_dd_2[2] = {};
bool ifei_dd_2_dirty = false;
char last_ifei_dd_2[2] = {};
char ifei_dd_3[2] = {};
bool ifei_dd_3_dirty = false;
char last_ifei_dd_3[2] = {};
char ifei_dd_4[2] = {};
bool ifei_dd_4_dirty = false;
char last_ifei_dd_4[2] = {};
char ifei_ff_l[4] = {};
bool ifei_ff_l_dirty = false;
char last_ifei_ff_l[4] = {};
char ifei_ff_r[4] = {};
bool ifei_ff_r_dirty = false;
char last_ifei_ff_r[4] = {};
char ifei_ff_texture[2] = {};
bool ifei_ff_texture_dirty = false;
char last_ifei_ff_texture[2] = {};
char ifei_fuel_down[7] = {};
bool ifei_fuel_down_dirty = false;
char last_ifei_fuel_down[7] = {};
char ifei_fuel_up[7] = {};
bool ifei_fuel_up_dirty = false;
char last_ifei_fuel_up[7] = {};
char ifei_l0_texture[2] = {};
bool ifei_l0_texture_dirty = false;
char last_ifei_l0_texture[2] = {};
char ifei_l100_texture[2] = {};
bool ifei_l100_texture_dirty = false;
char last_ifei_l100_texture[2] = {};
char ifei_l50_texture[2] = {};
bool ifei_l50_texture_dirty = false;
char last_ifei_l50_texture[2] = {};
char ifei_lpointer_texture[2] = {};
bool ifei_lpointer_texture_dirty = false;
char last_ifei_lpointer_texture[2] = {};
char ifei_lscale_texture[2] = {};
bool ifei_lscale_texture_dirty = false;
char last_ifei_lscale_texture[2] = {};
char ifei_l_texture[2] = {};
bool ifei_l_texture_dirty = false;
char last_ifei_l_texture[2] = {};
char ifei_noz_texture[2] = {};
bool ifei_noz_texture_dirty = false;
char last_ifei_noz_texture[2] = {};
char ifei_oil_press_l[4] = {};
bool ifei_oil_press_l_dirty = false;
char last_ifei_oil_press_l[4] = {};
char ifei_oil_press_r[4] = {};
bool ifei_oil_press_r_dirty = false;
char last_ifei_oil_press_r[4] = {};
char ifei_oil_texture[2] = {};
bool ifei_oil_texture_dirty = false;
char last_ifei_oil_texture[2] = {};
char ifei_r0_texture[2] = {};
bool ifei_r0_texture_dirty = false;
char last_ifei_r0_texture[2] = {};
char ifei_r100_texture[2] = {};
bool ifei_r100_texture_dirty = false;
char last_ifei_r100_texture[2] = {};
char ifei_r50_texture[2] = {};
bool ifei_r50_texture_dirty = false;
char last_ifei_r50_texture[2] = {};
char ifei_rpm_l[4] = {};
bool ifei_rpm_l_dirty = false;
char last_ifei_rpm_l[4] = {};
char ifei_rpm_r[4] = {};
bool ifei_rpm_r_dirty = false;
char last_ifei_rpm_r[4] = {};
char ifei_rpm_texture[2] = {};
bool ifei_rpm_texture_dirty = false;
char last_ifei_rpm_texture[2] = {};
char ifei_rpointer_texture[2] = {};
bool ifei_rpointer_texture_dirty = false;
char last_ifei_rpointer_texture[2] = {};
char ifei_rscale_texture[2] = {};
bool ifei_rscale_texture_dirty = false;
char last_ifei_rscale_texture[2] = {};
char ifei_r_texture[2] = {};
bool ifei_r_texture_dirty = false;
char last_ifei_r_texture[2] = {};
char ifei_sp[4] = {};
bool ifei_sp_dirty = false;
char last_ifei_sp[4] = {};
char ifei_t[7] = {};
bool ifei_t_dirty = false;
char last_ifei_t[7] = {};
char ifei_temp_l[4] = {};
bool ifei_temp_l_dirty = false;
char last_ifei_temp_l[4] = {};
char ifei_temp_r[4] = {};
bool ifei_temp_r_dirty = false;
char last_ifei_temp_r[4] = {};
char ifei_temp_texture[2] = {};
bool ifei_temp_texture_dirty = false;
char last_ifei_temp_texture[2] = {};
char ifei_timer_h[3] = {};
bool ifei_timer_h_dirty = false;
char last_ifei_timer_h[3] = {};
char ifei_timer_m[3] = {};
bool ifei_timer_m_dirty = false;
char last_ifei_timer_m[3] = {};
char ifei_timer_s[3] = {};
bool ifei_timer_s_dirty = false;
char last_ifei_timer_s[3] = {};
char ifei_time_set_mode[7] = {};
bool ifei_time_set_mode_dirty = false;
char last_ifei_time_set_mode[7] = {};
char ifei_z_texture[2] = {};
bool ifei_z_texture_dirty = false;
char last_ifei_z_texture[2] = {};
char ufc_comm1_display[3] = {};
bool ufc_comm1_display_dirty = false;
char last_ufc_comm1_display[3] = {};
char ufc_comm2_display[3] = {};
bool ufc_comm2_display_dirty = false;
char last_ufc_comm2_display[3] = {};
char ufc_option_cueing_1[2] = {};
bool ufc_option_cueing_1_dirty = false;
char last_ufc_option_cueing_1[2] = {};
char ufc_option_cueing_2[2] = {};
bool ufc_option_cueing_2_dirty = false;
char last_ufc_option_cueing_2[2] = {};
char ufc_option_cueing_3[2] = {};
bool ufc_option_cueing_3_dirty = false;
char last_ufc_option_cueing_3[2] = {};
char ufc_option_cueing_4[2] = {};
bool ufc_option_cueing_4_dirty = false;
char last_ufc_option_cueing_4[2] = {};
char ufc_option_cueing_5[2] = {};
bool ufc_option_cueing_5_dirty = false;
char last_ufc_option_cueing_5[2] = {};
char ufc_option_display_1[5] = {};
bool ufc_option_display_1_dirty = false;
char last_ufc_option_display_1[5] = {};
char ufc_option_display_2[5] = {};
bool ufc_option_display_2_dirty = false;
char last_ufc_option_display_2[5] = {};
char ufc_option_display_3[5] = {};
bool ufc_option_display_3_dirty = false;
char last_ufc_option_display_3[5] = {};
char ufc_option_display_4[5] = {};
bool ufc_option_display_4_dirty = false;
char last_ufc_option_display_4[5] = {};
char ufc_option_display_5[5] = {};
bool ufc_option_display_5_dirty = false;
char last_ufc_option_display_5[5] = {};
char ufc_scratchpad_number_display[9] = {};
bool ufc_scratchpad_number_display_dirty = false;
char last_ufc_scratchpad_number_display[9] = {};
char ufc_scratchpad_string_1_display[3] = {};
bool ufc_scratchpad_string_1_display_dirty = false;
char last_ufc_scratchpad_string_1_display[3] = {};
char ufc_scratchpad_string_2_display[3] = {};
bool ufc_scratchpad_string_2_display_dirty = false;
char last_ufc_scratchpad_string_2_display[3] = {};
char dcs_bios[7] = {};
bool dcs_bios_dirty = false;
char last_dcs_bios[7] = {};
char pilotname[25] = {};
bool pilotname_dirty = false;
char last_pilotname[25] = {};
char _acft_name[25] = {};
bool _acft_name_dirty = false;
char last__acft_name[25] = {};
char lat_z_dir[2] = {};
bool lat_z_dir_dirty = false;
char last_lat_z_dir[2] = {};
char lon_z_dir[2] = {};
bool lon_z_dir_dirty = false;
char last_lon_z_dir[2] = {};
char angular_velocity_x[7] = {};
bool angular_velocity_x_dirty = false;
char last_angular_velocity_x[7] = {};
char angular_velocity_y[7] = {};
bool angular_velocity_y_dirty = false;
char last_angular_velocity_y[7] = {};
char angular_velocity_z[7] = {};
bool angular_velocity_z_dirty = false;
char last_angular_velocity_z[7] = {};
char g_load[5] = {};
bool g_load_dirty = false;
char last_g_load[5] = {};
char ias_eu[5] = {};
bool ias_eu_dirty = false;
char last_ias_eu[5] = {};
char ias_us[5] = {};
bool ias_us_dirty = false;
char last_ias_us[5] = {};
char miss_time[9] = {};
bool miss_time_dirty = false;
char last_miss_time[9] = {};
char mod_time[7] = {};
bool mod_time_dirty = false;
char last_mod_time[7] = {};

DisplayBufferEntry CT_DisplayBuffers[] = {
    { "HUD_LTDR", hud_ltdr, 5, &hud_ltdr_dirty, last_hud_ltdr },
    { "IFEI_BINGO", ifei_bingo, 5, &ifei_bingo_dirty, last_ifei_bingo },
    { "IFEI_BINGO_TEXTURE", ifei_bingo_texture, 1, &ifei_bingo_texture_dirty, last_ifei_bingo_texture },
    { "IFEI_CLOCK_H", ifei_clock_h, 2, &ifei_clock_h_dirty, last_ifei_clock_h },
    { "IFEI_CLOCK_M", ifei_clock_m, 2, &ifei_clock_m_dirty, last_ifei_clock_m },
    { "IFEI_CLOCK_S", ifei_clock_s, 2, &ifei_clock_s_dirty, last_ifei_clock_s },
    { "IFEI_CODES", ifei_codes, 3, &ifei_codes_dirty, last_ifei_codes },
    { "IFEI_DD_1", ifei_dd_1, 1, &ifei_dd_1_dirty, last_ifei_dd_1 },
    { "IFEI_DD_2", ifei_dd_2, 1, &ifei_dd_2_dirty, last_ifei_dd_2 },
    { "IFEI_DD_3", ifei_dd_3, 1, &ifei_dd_3_dirty, last_ifei_dd_3 },
    { "IFEI_DD_4", ifei_dd_4, 1, &ifei_dd_4_dirty, last_ifei_dd_4 },
    { "IFEI_FF_L", ifei_ff_l, 3, &ifei_ff_l_dirty, last_ifei_ff_l },
    { "IFEI_FF_R", ifei_ff_r, 3, &ifei_ff_r_dirty, last_ifei_ff_r },
    { "IFEI_FF_TEXTURE", ifei_ff_texture, 1, &ifei_ff_texture_dirty, last_ifei_ff_texture },
    { "IFEI_FUEL_DOWN", ifei_fuel_down, 6, &ifei_fuel_down_dirty, last_ifei_fuel_down },
    { "IFEI_FUEL_UP", ifei_fuel_up, 6, &ifei_fuel_up_dirty, last_ifei_fuel_up },
    { "IFEI_L0_TEXTURE", ifei_l0_texture, 1, &ifei_l0_texture_dirty, last_ifei_l0_texture },
    { "IFEI_L100_TEXTURE", ifei_l100_texture, 1, &ifei_l100_texture_dirty, last_ifei_l100_texture },
    { "IFEI_L50_TEXTURE", ifei_l50_texture, 1, &ifei_l50_texture_dirty, last_ifei_l50_texture },
    { "IFEI_LPOINTER_TEXTURE", ifei_lpointer_texture, 1, &ifei_lpointer_texture_dirty, last_ifei_lpointer_texture },
    { "IFEI_LSCALE_TEXTURE", ifei_lscale_texture, 1, &ifei_lscale_texture_dirty, last_ifei_lscale_texture },
    { "IFEI_L_TEXTURE", ifei_l_texture, 1, &ifei_l_texture_dirty, last_ifei_l_texture },
    { "IFEI_NOZ_TEXTURE", ifei_noz_texture, 1, &ifei_noz_texture_dirty, last_ifei_noz_texture },
    { "IFEI_OIL_PRESS_L", ifei_oil_press_l, 3, &ifei_oil_press_l_dirty, last_ifei_oil_press_l },
    { "IFEI_OIL_PRESS_R", ifei_oil_press_r, 3, &ifei_oil_press_r_dirty, last_ifei_oil_press_r },
    { "IFEI_OIL_TEXTURE", ifei_oil_texture, 1, &ifei_oil_texture_dirty, last_ifei_oil_texture },
    { "IFEI_R0_TEXTURE", ifei_r0_texture, 1, &ifei_r0_texture_dirty, last_ifei_r0_texture },
    { "IFEI_R100_TEXTURE", ifei_r100_texture, 1, &ifei_r100_texture_dirty, last_ifei_r100_texture },
    { "IFEI_R50_TEXTURE", ifei_r50_texture, 1, &ifei_r50_texture_dirty, last_ifei_r50_texture },
    { "IFEI_RPM_L", ifei_rpm_l, 3, &ifei_rpm_l_dirty, last_ifei_rpm_l },
    { "IFEI_RPM_R", ifei_rpm_r, 3, &ifei_rpm_r_dirty, last_ifei_rpm_r },
    { "IFEI_RPM_TEXTURE", ifei_rpm_texture, 1, &ifei_rpm_texture_dirty, last_ifei_rpm_texture },
    { "IFEI_RPOINTER_TEXTURE", ifei_rpointer_texture, 1, &ifei_rpointer_texture_dirty, last_ifei_rpointer_texture },
    { "IFEI_RSCALE_TEXTURE", ifei_rscale_texture, 1, &ifei_rscale_texture_dirty, last_ifei_rscale_texture },
    { "IFEI_R_TEXTURE", ifei_r_texture, 1, &ifei_r_texture_dirty, last_ifei_r_texture },
    { "IFEI_SP", ifei_sp, 3, &ifei_sp_dirty, last_ifei_sp },
    { "IFEI_T", ifei_t, 6, &ifei_t_dirty, last_ifei_t },
    { "IFEI_TEMP_L", ifei_temp_l, 3, &ifei_temp_l_dirty, last_ifei_temp_l },
    { "IFEI_TEMP_R", ifei_temp_r, 3, &ifei_temp_r_dirty, last_ifei_temp_r },
    { "IFEI_TEMP_TEXTURE", ifei_temp_texture, 1, &ifei_temp_texture_dirty, last_ifei_temp_texture },
    { "IFEI_TIMER_H", ifei_timer_h, 2, &ifei_timer_h_dirty, last_ifei_timer_h },
    { "IFEI_TIMER_M", ifei_timer_m, 2, &ifei_timer_m_dirty, last_ifei_timer_m },
    { "IFEI_TIMER_S", ifei_timer_s, 2, &ifei_timer_s_dirty, last_ifei_timer_s },
    { "IFEI_TIME_SET_MODE", ifei_time_set_mode, 6, &ifei_time_set_mode_dirty, last_ifei_time_set_mode },
    { "IFEI_Z_TEXTURE", ifei_z_texture, 1, &ifei_z_texture_dirty, last_ifei_z_texture },
    { "UFC_COMM1_DISPLAY", ufc_comm1_display, 2, &ufc_comm1_display_dirty, last_ufc_comm1_display },
    { "UFC_COMM2_DISPLAY", ufc_comm2_display, 2, &ufc_comm2_display_dirty, last_ufc_comm2_display },
    { "UFC_OPTION_CUEING_1", ufc_option_cueing_1, 1, &ufc_option_cueing_1_dirty, last_ufc_option_cueing_1 },
    { "UFC_OPTION_CUEING_2", ufc_option_cueing_2, 1, &ufc_option_cueing_2_dirty, last_ufc_option_cueing_2 },
    { "UFC_OPTION_CUEING_3", ufc_option_cueing_3, 1, &ufc_option_cueing_3_dirty, last_ufc_option_cueing_3 },
    { "UFC_OPTION_CUEING_4", ufc_option_cueing_4, 1, &ufc_option_cueing_4_dirty, last_ufc_option_cueing_4 },
    { "UFC_OPTION_CUEING_5", ufc_option_cueing_5, 1, &ufc_option_cueing_5_dirty, last_ufc_option_cueing_5 },
    { "UFC_OPTION_DISPLAY_1", ufc_option_display_1, 4, &ufc_option_display_1_dirty, last_ufc_option_display_1 },
    { "UFC_OPTION_DISPLAY_2", ufc_option_display_2, 4, &ufc_option_display_2_dirty, last_ufc_option_display_2 },
    { "UFC_OPTION_DISPLAY_3", ufc_option_display_3, 4, &ufc_option_display_3_dirty, last_ufc_option_display_3 },
    { "UFC_OPTION_DISPLAY_4", ufc_option_display_4, 4, &ufc_option_display_4_dirty, last_ufc_option_display_4 },
    { "UFC_OPTION_DISPLAY_5", ufc_option_display_5, 4, &ufc_option_display_5_dirty, last_ufc_option_display_5 },
    { "UFC_SCRATCHPAD_NUMBER_DISPLAY", ufc_scratchpad_number_display, 8, &ufc_scratchpad_number_display_dirty, last_ufc_scratchpad_number_display },
    { "UFC_SCRATCHPAD_STRING_1_DISPLAY", ufc_scratchpad_string_1_display, 2, &ufc_scratchpad_string_1_display_dirty, last_ufc_scratchpad_string_1_display },
    { "UFC_SCRATCHPAD_STRING_2_DISPLAY", ufc_scratchpad_string_2_display, 2, &ufc_scratchpad_string_2_display_dirty, last_ufc_scratchpad_string_2_display },
    { "DCS_BIOS", dcs_bios, 6, &dcs_bios_dirty, last_dcs_bios },
    { "PILOTNAME", pilotname, 24, &pilotname_dirty, last_pilotname },
    { "_ACFT_NAME", _acft_name, 24, &_acft_name_dirty, last__acft_name },
    { "LAT_Z_DIR", lat_z_dir, 1, &lat_z_dir_dirty, last_lat_z_dir },
    { "LON_Z_DIR", lon_z_dir, 1, &lon_z_dir_dirty, last_lon_z_dir },
    { "ANGULAR_VELOCITY_X", angular_velocity_x, 6, &angular_velocity_x_dirty, last_angular_velocity_x },
    { "ANGULAR_VELOCITY_Y", angular_velocity_y, 6, &angular_velocity_y_dirty, last_angular_velocity_y },
    { "ANGULAR_VELOCITY_Z", angular_velocity_z, 6, &angular_velocity_z_dirty, last_angular_velocity_z },
    { "G_LOAD", g_load, 4, &g_load_dirty, last_g_load },
    { "IAS_EU", ias_eu, 4, &ias_eu_dirty, last_ias_eu },
    { "IAS_US", ias_us, 4, &ias_us_dirty, last_ias_us },
    { "MISS_TIME", miss_time, 8, &miss_time_dirty, last_miss_time },
    { "MOD_TIME", mod_time, 6, &mod_time_dirty, last_mod_time },
};
const size_t numCTDisplayBuffers = sizeof(CT_DisplayBuffers)/sizeof(CT_DisplayBuffers[0]);

const DisplayBufferHashEntry CT_DisplayBufferHash[149] = {
    {nullptr, nullptr},
    {"UFC_SCRATCHPAD_NUMBER_DISPLAY", &CT_DisplayBuffers[57]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_RPM_TEXTURE", &CT_DisplayBuffers[31]},
    {nullptr, nullptr},
    {"IFEI_TIMER_H", &CT_DisplayBuffers[40]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_TIMER_M", &CT_DisplayBuffers[41]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_TIMER_S", &CT_DisplayBuffers[42]},
    {nullptr, nullptr},
    {"IFEI_OIL_TEXTURE", &CT_DisplayBuffers[25]},
    {nullptr, nullptr},
    {"IFEI_FF_TEXTURE", &CT_DisplayBuffers[13]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_L_TEXTURE", &CT_DisplayBuffers[21]},
    {"DCS_BIOS", &CT_DisplayBuffers[60]},
    {"IFEI_BINGO_TEXTURE", &CT_DisplayBuffers[2]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_R0_TEXTURE", &CT_DisplayBuffers[26]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_L0_TEXTURE", &CT_DisplayBuffers[16]},
    {"MOD_TIME", &CT_DisplayBuffers[72]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_TIME_SET_MODE", &CT_DisplayBuffers[43]},
    {nullptr, nullptr},
    {"PILOTNAME", &CT_DisplayBuffers[61]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_TEMP_L", &CT_DisplayBuffers[37]},
    {"LON_Z_DIR", &CT_DisplayBuffers[64]},
    {nullptr, nullptr},
    {"IAS_EU", &CT_DisplayBuffers[69]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_TEMP_R", &CT_DisplayBuffers[38]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_CLOCK_H", &CT_DisplayBuffers[3]},
    {nullptr, nullptr},
    {"MISS_TIME", &CT_DisplayBuffers[71]},
    {"IFEI_R_TEXTURE", &CT_DisplayBuffers[34]},
    {nullptr, nullptr},
    {"IFEI_CLOCK_M", &CT_DisplayBuffers[4]},
    {"UFC_OPTION_CUEING_1", &CT_DisplayBuffers[47]},
    {"UFC_OPTION_CUEING_2", &CT_DisplayBuffers[48]},
    {"UFC_OPTION_CUEING_3", &CT_DisplayBuffers[49]},
    {"UFC_OPTION_CUEING_4", &CT_DisplayBuffers[50]},
    {"UFC_OPTION_CUEING_5", &CT_DisplayBuffers[51]},
    {"IFEI_CLOCK_S", &CT_DisplayBuffers[5]},
    {"UFC_SCRATCHPAD_STRING_1_DISPLAY", &CT_DisplayBuffers[58]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_RPM_L", &CT_DisplayBuffers[29]},
    {"UFC_SCRATCHPAD_STRING_2_DISPLAY", &CT_DisplayBuffers[59]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_DD_1", &CT_DisplayBuffers[7]},
    {"IFEI_DD_2", &CT_DisplayBuffers[8]},
    {"IFEI_DD_3", &CT_DisplayBuffers[9]},
    {"IFEI_DD_4", &CT_DisplayBuffers[10]},
    {"IFEI_RPM_R", &CT_DisplayBuffers[30]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"HUD_LTDR", &CT_DisplayBuffers[0]},
    {nullptr, nullptr},
    {"IFEI_R100_TEXTURE", &CT_DisplayBuffers[27]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_FUEL_UP", &CT_DisplayBuffers[15]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_T", &CT_DisplayBuffers[36]},
    {"IFEI_RPOINTER_TEXTURE", &CT_DisplayBuffers[32]},
    {"IFEI_FF_L", &CT_DisplayBuffers[11]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_Z_TEXTURE", &CT_DisplayBuffers[44]},
    {"IFEI_FF_R", &CT_DisplayBuffers[12]},
    {"IFEI_LPOINTER_TEXTURE", &CT_DisplayBuffers[19]},
    {"IFEI_LSCALE_TEXTURE", &CT_DisplayBuffers[20]},
    {"IFEI_OIL_PRESS_L", &CT_DisplayBuffers[23]},
    {"IFEI_TEMP_TEXTURE", &CT_DisplayBuffers[39]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"IFEI_CODES", &CT_DisplayBuffers[6]},
    {"IFEI_OIL_PRESS_R", &CT_DisplayBuffers[24]},
    {nullptr, nullptr},
    {"IFEI_NOZ_TEXTURE", &CT_DisplayBuffers[22]},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {nullptr, nullptr},
    {"ANGULAR_VELOCITY_X", &CT_DisplayBuffers[65]},
    {"IFEI_FUEL_DOWN", &CT_DisplayBuffers[14]},
    {"IFEI_L100_TEXTURE", &CT_DisplayBuffers[17]},
    {"IFEI_L50_TEXTURE", &CT_DisplayBuffers[18]},
    {"UFC_OPTION_DISPLAY_1", &CT_DisplayBuffers[52]},
    {"UFC_COMM1_DISPLAY", &CT_DisplayBuffers[45]},
    {"UFC_OPTION_DISPLAY_2", &CT_DisplayBuffers[53]},
    {"UFC_OPTION_DISPLAY_3", &CT_DisplayBuffers[54]},
    {"UFC_OPTION_DISPLAY_4", &CT_DisplayBuffers[55]},
    {"IFEI_SP", &CT_DisplayBuffers[35]},
    {"UFC_OPTION_DISPLAY_5", &CT_DisplayBuffers[56]},
    {"UFC_COMM2_DISPLAY", &CT_DisplayBuffers[46]},
    {"_ACFT_NAME", &CT_DisplayBuffers[62]},
    {"ANGULAR_VELOCITY_Y", &CT_DisplayBuffers[66]},
    {"ANGULAR_VELOCITY_Z", &CT_DisplayBuffers[67]},
    {"IFEI_RSCALE_TEXTURE", &CT_DisplayBuffers[33]},
    {"G_LOAD", &CT_DisplayBuffers[68]},
    {"IAS_US", &CT_DisplayBuffers[70]},
    {"IFEI_BINGO", &CT_DisplayBuffers[1]},
    {"LAT_Z_DIR", &CT_DisplayBuffers[63]},
    {"IFEI_R50_TEXTURE", &CT_DisplayBuffers[28]},
    {nullptr, nullptr},
    {nullptr, nullptr},
};

const DisplayBufferEntry* findDisplayBufferByLabel(const char* label) {
    uint16_t startH = labelHash(label) % 149;
    for (uint16_t i = 0; i < 149; ++i) {
        uint16_t idx = (startH + i >= 149) ? (startH + i - 149) : (startH + i);
        const auto& entry = CT_DisplayBufferHash[idx];
        if (!entry.label) continue;
        if (strcmp(entry.label, label) == 0) return entry.entry;
    }
    return nullptr;
}


void renderField(const char* label, const char* strValue,
                 const DisplayFieldDefLabel* defOverride,
                 FieldState* stateOverride) {
    const DisplayFieldDefLabel* def = defOverride ? defOverride : findFieldDefByLabel(label);
    if (!def) return;
    if (!def->renderFunc) { debugPrintf("[DISPLAY] No renderFunc for label '%s', skipping\n", def->label); return; }

    FieldState* state = stateOverride;
    if (!state) {
        int idx = def - fieldDefs;
        state = &fieldStates[idx];
    }

    bool valid = true;
    if (def->type == FIELD_NUMERIC) {
        const int value = strToIntFast(strValue);
        valid = (value >= def->minValue && value <= def->maxValue);
    }
    const char* toShow = valid ? strValue : state->lastValue;

    // bound compare/copy by field length, clamp to cache size
    uint8_t need = def->numDigits ? def->numDigits : 1;
    if (need > sizeof(state->lastValue)) need = sizeof(state->lastValue);

    if (memcmp(toShow, state->lastValue, need) == 0) return;

    memcpy(state->lastValue, toShow, need);
    if (def->clearFunc) def->clearFunc(def->driver, def->segMap, *def);
    def->renderFunc(def->driver, def->segMap, toShow, *def);
}

